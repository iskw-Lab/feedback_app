# セキュリティポリシー

feedback_app プロジェクトのセキュリティポリシーです。

---

## 🔒 サポートされているバージョン

現在、以下のバージョンでセキュリティアップデートを提供しています：

| バージョン | サポート状況 |
| --------- | ----------- |
| Latest    | ✅          |
| < Latest  | ❌          |

**推奨**: 常に最新バージョンを使用してください。

---

## 🛡️ セキュリティ脆弱性の報告

セキュリティに関する問題を発見した場合は、以下のガイドラインに従って報告してください。

### ⚠️ 重要: 公開しないでください

セキュリティ脆弱性は**公開の GitHub Issue で報告しないでください**。これにより、悪意のある攻撃者が脆弱性を悪用する可能性があります。

### 報告方法

セキュリティ脆弱性を発見した場合は、以下のいずれかの方法で報告してください：

1. **GitHub Security Advisories（推奨）**
   - リポジトリの "Security" タブから "Report a vulnerability" を選択
   - [GitHub Security Advisories](https://github.com/iskw-Lab/feedback_app/security/advisories/new)

2. **メール（代替手段）**
   - プロジェクトメンテナーに直接メールで連絡
   - 件名に「[SECURITY] feedback_app」を含める

### 報告に含めるべき情報

脆弱性の報告には、以下の情報を含めてください：

- **脆弱性の種類** (例: XSS, SQL Injection, CSRF など)
- **影響を受けるコンポーネント** (例: ファイル名、関数名)
- **脆弱性の詳細な説明**
- **再現手順** (可能な限り詳細に)
- **概念実証コード** (PoC) があれば含める
- **影響範囲** (どのような被害が考えられるか)
- **推奨される修正方法** (あれば)

### 報告例

```
脆弱性の種類: クロスサイトスクリプティング (XSS)

影響を受けるコンポーネント:
- app/components/UserProfile.tsx (28行目)

詳細な説明:
ユーザー入力が適切にサニタイズされずに DOM に挿入されています。

再現手順:
1. プロフィール編集ページに移動
2. 名前フィールドに <script>alert('XSS')</script> を入力
3. 保存ボタンをクリック
4. プロフィールページを表示

影響範囲:
- セッションハイジャック
- Cookie の盗難
- フィッシング攻撃

推奨される修正:
DOMPurify などのライブラリを使用して入力をサニタイズする
```

---

## 📋 セキュリティ脆弱性の処理プロセス

### 1. 受理 (24時間以内)

- 報告を受け取り次第、24時間以内に受理の連絡をします
- 必要に応じて追加情報を依頼する場合があります

### 2. 調査 (1週間以内)

- 報告された脆弱性を検証します
- 影響範囲と深刻度を評価します
- 修正方法を検討します

### 3. 修正 (2週間以内)

- 脆弱性の修正を実装します
- テストを実施し、修正が有効であることを確認します
- 必要に応じてセキュリティアドバイザリを準備します

### 4. 公開

- 修正をリリースします
- セキュリティアドバイザリを公開します（該当する場合）
- 報告者に感謝の意を表します（希望する場合）

---

## 🎖️ 報奨プログラム

現在、正式な報奨プログラムはありませんが、セキュリティ脆弱性を報告していただいた方には：

- 修正後のセキュリティアドバイザリでクレジット表示（希望する場合）
- CONTRIBUTORS.md への記載
- 深く感謝の意を表します

---

## 🔐 セキュリティベストプラクティス

### 開発者向け

プロジェクトに貢献する際は、以下のセキュリティベストプラクティスに従ってください：

#### 認証・認可

- ✅ 全ての API エンドポイントで認証を実装
- ✅ Supabase の Row Level Security (RLS) を活用
- ✅ JWT トークンの有効期限を適切に設定

#### 入力検証

- ✅ 全てのユーザー入力を検証・サニタイズ
- ✅ SQL インジェクション対策（Supabase クライアントを使用）
- ✅ XSS 対策（React の自動エスケープを活用）

#### 機密情報の管理

- ✅ API キーやパスワードは環境変数で管理
- ✅ `.env` ファイルは `.gitignore` で除外
- ✅ 本番環境のキーは定期的にローテーション

#### ファイル操作

- ✅ パストラバーサル対策を実装
- ✅ アップロードファイルの検証
- ✅ ファイルサイズの制限

#### エラーハンドリング

- ✅ 詳細なエラー情報をユーザーに露出しない
- ✅ ログには機密情報を含めない
- ✅ 適切なエラーメッセージを返す

### ユーザー向け

#### 環境変数の保護

- 🔒 `.env.local` ファイルを他人と共有しない
- 🔒 API キーを定期的に更新する
- 🔒 開発環境と本番環境で異なるキーを使用する

#### 依存関係の管理

- 🔒 定期的に `npm audit` を実行
- 🔒 Dependabot のアラートに対応
- 🔒 不要な依存関係を削除

#### アクセス管理

- 🔒 最小権限の原則に従う
- 🔒 不要になったアクセス権は即座に削除
- 🔒 2要素認証 (2FA) を有効化

---

## 🚨 既知の脆弱性

現在、既知の脆弱性はありません。

過去のセキュリティアドバイザリは [GitHub Security Advisories](https://github.com/iskw-Lab/feedback_app/security/advisories) で確認できます。

---

## 📚 セキュリティリソース

### プロジェクト固有のドキュメント

- [セキュリティ監査レポート](./SECURITY_AUDIT_REPORT.md)
- [Public 公開チェックリスト](./PUBLIC_RELEASE_CHECKLIST.md)

### 外部リソース

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Supabase Security Best Practices](https://supabase.com/docs/guides/platform/going-into-prod)
- [Next.js Security Headers](https://nextjs.org/docs/advanced-features/security-headers)
- [GitHub Security Best Practices](https://docs.github.com/en/code-security)

---

## 📞 連絡先

セキュリティに関する一般的な質問は、GitHub の Issue または Discussion で行ってください。

機密情報を含む連絡は、上記の報告方法を使用してください。

---

**最終更新日**: 2025-12-08
